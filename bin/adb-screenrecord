#!/usr/bin/env bash

if [ $# == 0 ]; then
    echo "usage: $(basename $0) filename.mp4"
    exit
fi

filename="$1"

function stop {
  # Wait a moment for the movie to be written
  sleep 1
  adb pull /sdcard/screenrecord.mp4 $filename
  adb shell rm /sdcard/screenrecord.mp4
}

trap stop SIGINT

echo "Recording... (Press Ctrl-C to stop)"
adb shell screenrecord --verbose /sdcard/screenrecord.mp4
